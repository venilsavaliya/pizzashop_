@{
    ViewBag.active = "Dashboard";
}

<div class="d-flex justify-content-between w-100">
    <h3 class="custom-blue fw-bold m-2">Dashboard</h3>

    <div class="d-flex justify-content-between m-2" style="width: 300px;">
        <div class="dropdown bg-white border-0 w-100">
            <a class="btn fw-semibold text-muted dropdown-toggle w-100 d-flex justify-content-between align-items-center"
                id="timeRangeBtn" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Today
            </a>

            <ul class="dropdown-menu w-100 " style="cursor: pointer;">
                <li><span class="dropdown-item bg-white" onclick="changeTimeRange('Today')">Today</span></li>
                <li><span class="dropdown-item bg-white" onclick="changeTimeRange('Last 7 days')">Last 7 days</span>
                </li>
                <li><span class="dropdown-item bg-white" onclick="changeTimeRange('Last 30 Days')">Last 30
                        days</span></li>
                <li><span class="dropdown-item bg-white" onclick="changeTimeRange('Current Month')">Current
                        Month</span></li>
                <li><span class="dropdown-item bg-white" onclick="changeTimeRange('Custom Date')">Custom
                        Date</span>
                </li>
            </ul>
        </div>
    </div>



</div>



<div id="dashboard_container">

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>

    function changeTimeRange(name) {
        $("#timeRangeBtn").text(name); // Update button text

        const today = new Date();
        let startdate = new Date();
        let enddate = new Date();

        if (name === "Today") {
            // Start and end are both today
        }
        else if (name === "Last 7 days") {
            startdate.setDate(today.getDate() - 6); // Including today
        }
        else if (name === "Last 30 Days") {
            startdate.setDate(today.getDate() - 29);
        }
        else if (name === "Current Month") {
            startdate = new Date(today.getFullYear(), today.getMonth(), 1);
        }
        else if (name === "Custom Date") {
            // Trigger a date picker UI here if needed
            return;
        }

        // Format as yyyy-MM-dd
        const formatDate = (d) => d.toISOString().split('T')[0];
        const formattedStart = formatDate(startdate);
        const formattedEnd = formatDate(enddate);

        console.log("Start Date:", formattedStart);
        console.log("End Date:", formattedEnd);

        $.ajax({
            type:"Get",
            url:"/Admin/GetDashboardData",
            data:{
                startdate : formattedStart,
                enddate : formattedEnd
            },
            success : function (response){
                console.log(response);

                $("#dashboard_container").html(response);
            }
        })

        // You can now send these dates to backend via AJAX or form
        // Example:
        // fetchData(formattedStart, formattedEnd);
    }

   
</script>
